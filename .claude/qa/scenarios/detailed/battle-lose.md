# 시나리오: 전투 패배

**ID**: SC-005
**소요 시간**: 5분
**우선순위**: 높음
**담당 영역**: 전투 시스템, 게임오버

---

## 목적

전투에서 패배할 때의 처리가 정상적으로 이루어지는지 검증합니다.

---

## 사전 조건

1. [x] 전투 진입 완료 (BattleScene)
2. [x] 플레이어 HP를 낮추기 위해 여러 번 피격 필요

---

## 테스트 준비

**참고**: 일반적으로 슬라임 데미지 (1-5)로 플레이어 HP 100을 0으로 만들려면 많은 턴이 필요합니다. 테스트를 위해:

1. **방법 A**: 여러 번 전투하여 누적 데미지
2. **방법 B**: 코드에서 임시로 플레이어 HP를 낮게 설정
3. **방법 C**: 콘솔에서 플레이어 HP 수정

---

## 테스트 단계

### Step 1: 플레이어 HP 낮추기

**액션**:
1. 전투에서 몬스터 공격을 계속 받음
2. 또는 디버그로 HP 조정

**예상 결과**:
- 플레이어 HP 감소
- HP 바 색상 변화 (녹색→노랑→빨강)

---

### Step 2: 위험 상태 확인

**액션**:
1. 플레이어 HP가 20% 이하일 때 관찰

**예상 결과**:
- HP 바 빨간색
- (경고 효과 있다면 확인)

---

### Step 3: HP 0 도달

**액션**:
1. 몬스터 공격으로 HP 0 도달

**예상 결과**:
- 즉시 패배 판정
- 플레이어 턴 없음 (HP 0이면 행동 불가)
- 패배 메시지 표시

---

### Step 4: 패배 메시지

**액션**:
1. 패배 후 화면 관찰

**예상 결과**:
- "Defeat!" 또는 "Game Over" 메시지
- 전투 종료

---

### Step 5: 게임오버 처리

**액션**:
1. 패배 후 전환 대기

**예상 결과**:
- 게임오버 화면 표시
- 또는 메뉴 화면으로 복귀
- 재시작 옵션 제공

---

### Step 6: 재시작

**액션**:
1. 재시작 옵션 선택 (있다면)
2. 또는 New Game 선택

**예상 결과**:
- 게임 처음부터 시작
- 플레이어 상태 초기화

---

## 검증 항목

| # | 검증 내용 | Pass/Fail | 비고 |
|---|----------|-----------|------|
| 1 | HP 바 색상 변화 | [ ] | |
| 2 | HP 0 → 패배 판정 | [ ] | |
| 3 | 패배 메시지 표시 | [ ] | |
| 4 | 게임오버 화면/처리 | [ ] | |
| 5 | 재시작 가능 | [ ] | |
| 6 | 재시작 시 초기화 정상 | [ ] | |

---

## HP 바 색상 기준

| HP 비율 | 예상 색상 |
|---------|----------|
| 50-100% | 녹색 |
| 20-50% | 노랑 |
| 0-20% | 빨강 |

---

## 예외 케이스

- [ ] 동시 사망 (둘 다 HP 0) 처리
- [ ] HP가 음수로 가도 정상 처리
- [ ] 도망 실패 후 패배

---

## 관련 파일

- `src/scenes/BattleScene.ts`
- `src/scenes/MenuScene.ts` (게임오버 후 복귀)
- `src/ui/BattleUI.ts`
- `src/ui/HealthBar.ts`

---

## 변경 이력

| 날짜 | 변경 | 담당자 |
|------|------|--------|
| 2026-02-03 | 초기 작성 | @claude |
