# 게임 아키텍처

## 전체 구조

```
┌─────────────────────────────────────────────────────────────────┐
│                         Phaser Game                              │
│  ┌───────────────────────────────────────────────────────────┐  │
│  │                        Scenes                              │  │
│  │  ┌─────────┐  ┌──────────┐  ┌─────────┐  ┌───────────┐   │  │
│  │  │ Boot    │→│ Preload  │→│ Menu    │→│ Game      │   │  │
│  │  └─────────┘  └──────────┘  └─────────┘  └─────┬─────┘   │  │
│  │                                                 │          │  │
│  │                                           ┌─────▼─────┐   │  │
│  │                                           │ Battle    │   │  │
│  │                                           └───────────┘   │  │
│  └───────────────────────────────────────────────────────────┘  │
│                              │                                   │
│  ┌───────────────────────────▼───────────────────────────────┐  │
│  │                      Game Objects                          │  │
│  │  ┌──────────┐  ┌──────────┐  ┌──────────┐  ┌──────────┐  │  │
│  │  │ Player   │  │ Monster  │  │ NPC      │  │ Item     │  │  │
│  │  └──────────┘  └──────────┘  └──────────┘  └──────────┘  │  │
│  └───────────────────────────────────────────────────────────┘  │
│                              │                                   │
│  ┌───────────────────────────▼───────────────────────────────┐  │
│  │                       Systems                              │  │
│  │  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐    │  │
│  │  │ Input        │  │ Battle       │  │ Inventory    │    │  │
│  │  │ Controller   │  │ System       │  │ System       │    │  │
│  │  └──────────────┘  └──────────────┘  └──────────────┘    │  │
│  └───────────────────────────────────────────────────────────┘  │
│                              │                                   │
│  ┌───────────────────────────▼───────────────────────────────┐  │
│  │                         UI                                 │  │
│  │  ┌──────────┐  ┌──────────┐  ┌──────────┐  ┌──────────┐  │  │
│  │  │ HealthBar│  │ DialogBox│  │ BattleUI │  │ Inventory│  │  │
│  │  └──────────┘  └──────────┘  └──────────┘  └──────────┘  │  │
│  └───────────────────────────────────────────────────────────┘  │
└─────────────────────────────────────────────────────────────────┘
```

## 씬 플로우

```
┌─────────────────────────────────────────────────────────────────┐
│                         Game Flow                                │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  BootScene        PreloadScene       MenuScene                   │
│  ┌─────────┐     ┌─────────────┐    ┌────────────┐              │
│  │ 초기화   │ →  │ 에셋 로딩    │ → │ 메인 메뉴   │              │
│  │ 설정    │     │ 진행률 표시  │    │ 새 게임    │              │
│  └─────────┘     └─────────────┘    │ 이어하기   │              │
│                                      └──────┬─────┘              │
│                                             │                    │
│                                             ▼                    │
│  GameScene                                                       │
│  ┌────────────────────────────────────────────────┐             │
│  │  던전 탐험                                       │             │
│  │  ┌─────────────────────────────────────────┐   │             │
│  │  │ - 플레이어 이동 (WASD / Arrow)           │   │             │
│  │  │ - 타일맵 충돌                            │   │             │
│  │  │ - 몬스터 조우                            │   │             │
│  │  │ - NPC 대화                               │   │             │
│  │  │ - 아이템 획득                            │   │             │
│  │  └─────────────────────────────────────────┘   │             │
│  └────────────────────┬───────────────────────────┘             │
│                       │ 몬스터 접촉                              │
│                       ▼                                          │
│  BattleScene                                                     │
│  ┌────────────────────────────────────────────────┐             │
│  │  턴제 전투                                       │             │
│  │  ┌─────────────────────────────────────────┐   │             │
│  │  │ - 공격 / 스킬 / 아이템 / 도망            │   │             │
│  │  │ - 데미지 계산                            │   │             │
│  │  │ - 전투 애니메이션                        │   │             │
│  │  │ - 승리 / 패배 처리                       │   │             │
│  │  └─────────────────────────────────────────┘   │             │
│  └────────────────────┬───────────────────────────┘             │
│                       │ 전투 종료                                │
│                       ▼                                          │
│                  GameScene (복귀)                                │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

## 데이터 흐름

```
┌───────────────┐     ┌───────────────┐     ┌───────────────┐
│   User Input  │     │    Systems    │     │   Game State  │
│               │     │               │     │               │
│  키보드/마우스  │ →  │  로직 처리     │ →  │  상태 업데이트  │
│               │     │               │     │               │
└───────────────┘     └───────────────┘     └───────┬───────┘
                                                     │
                      ┌──────────────────────────────┘
                      ▼
┌───────────────────────────────────────────────────────────────┐
│                        Rendering                               │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐           │
│  │ Entities    │  │ UI          │  │ Effects     │           │
│  │ 스프라이트   │  │ 체력바/메뉴  │  │ 파티클/트윈  │           │
│  └─────────────┘  └─────────────┘  └─────────────┘           │
└───────────────────────────────────────────────────────────────┘
```

## 엔티티 계층

```
Phaser.GameObjects.Sprite
         │
    ┌────┴────┐
    │  Entity │  (추상 기본 클래스)
    │  - health
    │  - position
    │  - takeDamage()
    └────┬────┘
         │
    ┌────┼────────────┬────────────┐
    │    │            │            │
┌───▼──┐ ┌───▼──┐  ┌───▼──┐  ┌───▼──┐
│Player│ │Monster│  │ NPC  │  │ Item │
│      │ │      │  │      │  │      │
│attack│ │damage│  │dialog│  │effect│
│defend│ │loot  │  │quest │  │      │
│skills│ │AI    │  │      │  │      │
└──────┘ └──────┘  └──────┘  └──────┘
```

## 변경 이력

| 날짜 | 변경 | 담당자 |
|------|------|--------|
| 2026-02-03 | 초기 생성 | @claude |
